{% extends 'base.html' %}
{% load static %}

{% block background_frame %}
<img src="{% static 'codemon/images/frames/bg_frame_blue.png' %}" 
     alt="" 
     class="bg-frame"
     onerror="this.style.display='none';">
{% endblock %}

{% block title %}システム作成 - Codemon{% endblock %}

{% block extra_css %}
<link href="{% static 'codemon/css/tutorial_overlay.css' %}" rel="stylesheet">
{% include 'system/_styles.html' %}
{% endblock %}

{% block content %}
{% include 'system/_content.html' %}
{% endblock %}

{% block extra_js %}
{% include 'system/_blockly_loader.html' %}
{% include 'system/_drag_drop.html' %}
{% include 'system/_history.html' %}
{% include 'system/_preview.html' %}
{% include 'system/_element_creators.html' %}
{% include 'system/_initialization.html' %}

<script src="{% static 'codemon/js/tutorial_overlay.js' %}"></script>
<script src="{% static 'codemon/js/tutorial_helper.js' %}"></script>
<script src="{% static 'codemon/js/tutorial_manager.js' %}"></script>
<script src="{% static 'codemon/js/tutorials/tutorial_seikai.js' %}"></script>
<script src="{% static 'codemon/js/tutorials/tutorial_fuseikai.js' %}"></script>
<script src="{% static 'codemon/js/tutorials/tutorial_mondai.js' %}"></script>
<script>
console.log('システム編集画面を読み込みました');

// getCookie関数を定義（グローバルスコープ）
function getCookie(name) {
  let cookieValue = null;
  if (document.cookie && document.cookie !== '') {
    const cookies = document.cookie.split(';');
    for (let i = 0; i < cookies.length; i++) {
      const cookie = cookies[i].trim();
      if (cookie.substring(0, name.length + 1) === (name + '=')) {
        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
        break;
      }
    }
  }
  return cookieValue;
}

// チュートリアル自動開始
if (window.tutorialManager) {
  document.addEventListener('DOMContentLoaded', function() {
    tutorialManager.autoStart();
  });
}
</script>
{% endblock %}

{% block ai_chat_widget %}
  {% include 'includes/ai_chat_base.html' %}
{% endblock %}
