{% extends 'base.html' %}
{% load static %}

{% block title %}ã‚·ã‚¹ãƒ†ãƒ é¸æŠ - Codemon{% endblock %}

{% block extra_css %}
<style>
.bg-frame {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: -1;
  object-fit: cover;
  pointer-events: none;
}
.center-buttons {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 70vh;
  margin-top: 120px;
}
  justify-content: flex-start;
  min-height: 70vh;
  margin-top: 120px;
}
.button-row {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  gap: 25px;
  justify-content: center;
  margin-bottom: 32px;
}
.main-button {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-decoration: none;
  color: #222;
  background: none;
  border: none;
  min-width: 338px;
  min-height: 208px;
  padding: 0;
  cursor: pointer;
  position: relative;
}
.button-img {
  width: 100%;
  max-width: 338px;
  height: 182px;
  aspect-ratio: 2/1;
  object-fit: contain;
  margin-bottom: 0;
}
.button-text {
  font-size: 1.3rem;
  font-weight: bold;
  color: #222;
  text-align: center;
  text-decoration: none;
  position: absolute;
  top: 91px;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  padding: 0 10px;
  box-sizing: border-box;
  z-index: 1;
}
</style>
<style>
.ai-chat-widget {
  position: fixed;
  right: 80px;
  bottom: 80px;
  z-index: 100;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
}
.ai-avatar {
  width: 120px;
  height: auto;
  box-shadow: none;
  background: none;
  object-fit: contain;
  margin-bottom: 10px;
}
.ai-chat-bubble {
  margin-bottom: 8px;
  background: #f5f7ff;
  border-radius: 18px 18px 0 18px;
  padding: 16px 20px;
  color: #222;
  font-size: 1.1rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  max-width: 320px;
}
.ai-chat-form {
  display: flex;
  gap: 8px;
  margin-top: 8px;
}
.ai-chat-input {
  border-radius: 12px;
  border: 1px solid #ccc;
  padding: 8px 12px;
  font-size: 1rem;
  width: 180px;
}
.ai-chat-send {
  border-radius: 12px;
  background: #2b4ca7;
  color: #fff;
  border: none;
  padding: 8px 16px;
  font-size: 1rem;
  cursor: pointer;
}
</style>
<style>
/* ãƒœã‚¿ãƒ³è¡Œã®2ç•ªç›®ã®è¦ç´ ï¼ˆæ–°è¦ã‚·ã‚¹ãƒ†ãƒ ä½œæˆãƒœã‚¿ãƒ³ï¼‰ã«é©ç”¨ */
.button-row a:last-child {
  position: relative;
  top: -30px; /* ä¸Šæ–¹å‘ã«30pxç§»å‹• (ãƒã‚¤ãƒŠã‚¹å€¤ã§ä¸Šã«å‹•ã) */
}
</style>
{% endblock %}
{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.querySelector('.ai-chat-form');
  const input = document.querySelector('.ai-chat-input');
  form.addEventListener('submit', function(e) {
    e.preventDefault();
    const text = input.value.trim();
    if (!text) return;
    const bubble = document.createElement('div');
    bubble.className = 'ai-chat-bubble';
    bubble.textContent = text;
    widget.insertBefore(bubble, form);
    input.value = '';
  });
});
</script>
{% endblock %}

{% block background_frame %}
  <img src="{% static 'codemon/images/backgrounds/bg_common.png' %}" alt="å¤–æ " class="bg-frame" onerror="this.style.display='none';">
{% endblock %}

{% block content %}

<div class="center-buttons">
  <div class="button-row">
    <a href="/accounts/system/list/" class="main-button">
      <img src="{% static 'codemon/images/button/system_blue.png' %}" class="button-img" alt="ã‚·ã‚¹ãƒ†ãƒ ä¸€è¦§">
      <span class="button-text">ã‚·ã‚¹ãƒ†ãƒ ä¸€è¦§</span>
    </a>
    <a href="/accounts/system/create/" class="main-button">
      <img src="{% static 'codemon/images/button/system_blue.png' %}" class="button-img" alt="æ–°è¦ä½œæˆ">
      <span class="button-text">æ–°è¦ã‚·ã‚¹ãƒ†ãƒ ä½œæˆ</span>
    </a>
  </div>
</div>

<div style="text-align:center; margin-top:40px; color:#555; font-size:1.1rem;">
  <p>ã”å¸Œæœ›ã®ã‚·ã‚¹ãƒ†ãƒ ã‚’é¸æŠã™ã‚‹ã‹ã€æ–°è¦ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>
</div>

<!-- karihome chat widget start -->
<div class="karihome-container">
  <div class="speech-bubble-container">
    <div class="speech-bubble">
      <p class="text-fun" id="characterMumble" style="margin: 0;"></p>
    </div>
  </div>
  <button class="chat-trigger-btn" id="chatTriggerBtn">
    ğŸ’¬ è©±ã—ã‹ã‘ã‚‹
    <span class="sparkle">âœ¨</span>
    <span class="sparkle">â­</span>
    <span class="sparkle">âœ¨</span>
    <span class="sparkle">â­</span>
  </button>
  <div class="character-container">
    <img src="{% if character_img %}{{ character_img }}{% else %}{% static 'codemon/images/characters/inu.png' %}{% endif %}" alt="AIã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼" class="ai-avatar" onerror="this.onerror=null;this.src='{% static 'codemon/images/characters/inu.png' %}';">
  </div>
  <form class="ai-chat-form" style="display:none;">
    <input type="text" class="ai-chat-input" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›">
    <button type="submit" class="ai-chat-send">é€ä¿¡</button>
  </form>
</div>
<div class="chat-modal" id="chatModal">
  <div class="chat-window">
    <div class="chat-header">
      <h2 id="chatHeaderTitle">{{ ai_name|default:'ã†ãŸãƒ¼' }} ã¨ ãŠã¯ãªã—</h2>
      <button class="chat-close-btn" id="closeChatBtn">Ã—</button>
    </div>
    <div class="chat-messages" id="chatMessages">
      <div class="chat-message ai">
        <div class="chat-message-content">
          ã“ã‚“ã«ã¡ã¯ï¼ã¼ãã¯{{ ai_name|default:'ã†ãŸãƒ¼' }}ã ã‚ˆï¼<br>
          ãªã‚“ã§ã‚‚ãã„ã¦ã­ï¼âœ¨
        </div>
      </div>
    </div>
    <div class="chat-loading" id="chatLoading">
      {{ ai_name|default:'ã†ãŸãƒ¼' }}ãŒè€ƒãˆä¸­...ğŸ¤”
    </div>
    <div class="chat-input-area">
      <input type="text" class="chat-input" id="chatInput" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ã­ï¼">
      <button class="chat-send-btn" id="sendChatBtn">é€ä¿¡</button>
    </div>
  </div>
</div>
<!-- karihome chat widget end -->

{% endblock %}
