{% extends 'base.html' %}
{% load static %}

{% block background_frame %}
<img src="{% static 'codemon/images/frames/bg_frame_blue.png' %}" 
     alt="" 
     class="bg-frame"
     onerror="this.style.display='none';">
{% endblock %}

{% block title %}システム削除確認 - Codemon{% endblock %}

{% block extra_css %}
<style>
  /* ナビゲーション表示状態の制御 */
  .top-tabs {
    display: block;
  }

  main {
    margin: 120px auto 20px auto;
    max-width: 980px;
    box-sizing: border-box;
  }
    .card {
      background:#fff; border-radius:10px; padding:18px; box-shadow:0 6px 18px rgba(10,10,10,0.04);
      border:1px solid #eef2f6; margin:110px auto 18px auto; max-width:820px;
    }

    .warning-box {
      background:#fff3cd; border:1px solid #ffc107; border-radius:8px; padding:6px; margin:6px 0;
      color:#856404;
    }
    .warning-box h3 {
      margin:0 0 8px 0; font-size:16px; color:#d32f2f;
    }

    form.delete-form{ display:flex; flex-direction:column; gap:12px; }
    .form-row{ display:flex; flex-direction:column; gap:6px; }
    label{ font-weight:600; font-size:14px; color:#333; }
    input[type="text"], textarea{
      padding:10px; border-radius:8px; border:1px solid #dfe6ef; background:#f7f9fc; color:#333;
      font-size:14px; resize:vertical;
    }
    textarea{
      resize: none;
      overflow-y: auto;
      height: 80px;
    }
    input[disabled], textarea[disabled]{
      opacity:1;
      cursor:default;
      background:#fafbff;
    }

    .card-actions{ display:flex; justify-content:flex-end; gap:10px; margin-top:18px; }
    .btn{
      padding:10px 16px; border-radius:8px; border:1px solid #d0d7de; background:#fff; cursor:pointer; font-size:14px;
      font-weight:600;
    }
    .btn.danger{ background:#d32f2f; color:#fff; border-color:transparent; box-shadow:0 4px 10px rgba(211,47,47,0.12); }
    .btn.danger:hover{ background:#b71c1c; }
    .btn.ghost{ background:transparent; color:var(--muted); border-color:transparent; }
    .btn.ghost:hover{ background:#f5f5f5; }
</style>
{% endblock %}

{% block content %}
  <div class="card" role="region" aria-label="削除確認内容">
      <div class="warning-box">
        <p>以下のシステムを削除しようとしています。</p>
        <p><strong>この操作は取り消すことができません。</strong></p>
      </div>

      <form method="post" class="delete-form" aria-label="削除するシステム情報">
        {% csrf_token %}
        
        <div class="form-row">
          <label for="system-name">システム名</label>
          <input id="system-name" name="name" type="text" value="{{ system_name }}" disabled aria-disabled="true" />
        </div>

        <div class="form-row">
          <label for="system-summary">システムの詳細</label>
          <textarea id="system-summary" name="summary" rows="6" disabled aria-disabled="true">{{ system_description }}</textarea>
        </div>

        <div class="form-row">
          <label for="created-at">作成日時</label>
          <input id="created-at" name="created_at" type="text" value="{{ created_at|date:'Y年n月j日 H:i' }}" disabled aria-disabled="true" />
        </div>

        <div class="card-actions" role="group" aria-label="操作">
          <button type="button" class="btn ghost" id="btn-cancel" title="キャンセル">キャンセル</button>
          <button type="submit" class="btn danger" title="削除を実行">削除する</button>
        </div>
      </form>
    </div>
{% endblock %}

{% block extra_js %}
<script>
    // ナビタブ見た目切替 + 遷移
    document.querySelectorAll('.nav-tab').forEach(tab=>{
      tab.addEventListener('click', function(e){
        e.preventDefault();
        document.querySelectorAll('.nav-tab').forEach(t=>{
          t.classList.remove('active');
          t.setAttribute('aria-pressed','false');
        });
        this.classList.add('active');
        this.setAttribute('aria-pressed','true');

        // システムタブ: システム選択画面へ遷移
        if (this.id === 'tab-system') {
          window.location.href = '/accounts/system/choice/';
          return;
        }

        // アルゴリズムタブ押下で block/choiceへ遷移
        if (this.id === 'tab-algorithm') {
          window.location.href = '/accounts/block/choice';
          return;
        }

        // 他タブは現在遷移先なし（見た目切替のみ）
      });
    });

    // キャンセルボタン: 詳細画面に戻る
    document.getElementById('btn-cancel').addEventListener('click', function(){
      const systemId = '{{ system_id }}';
      window.location.href = '/accounts/system/details/?id=' + systemId;
    });
</script>
{% endblock %}
