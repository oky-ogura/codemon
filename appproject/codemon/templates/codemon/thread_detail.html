{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container my-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>{{ thread.title }}</h2>
    <div>
      {% if thread.group %}
        <small class="text-muted">グループ: {{ thread.group.group_name }}</small>
      {% endif %}
      {% if request.user == thread.created_by %}
        <a class="btn btn-sm btn-outline-secondary ms-2" href="{% url 'codemon:thread_edit' thread_id=thread.thread_id %}">編集</a>
        <form action="{% url 'codemon:thread_delete' thread_id=thread.thread_id %}" method="post" class="d-inline">
          {% csrf_token %}
          <button class="btn btn-sm btn-outline-danger" onclick="return confirm('このスレッドを削除しますか？');">削除</button>
        </form>
      {% endif %}
    </div>
  </div>

  {% if thread.description %}
    <div class="mb-3 text-muted">{{ thread.description }}</div>
  {% endif %}

  <div class="card">
    <div class="card-body">
      {% if messages %}
        <ul class="list-group">
          {% for m in messages %}
            <li class="list-group-item">
              <strong>{{ m.sender.user_name }}</strong> <small class="text-muted">{{ m.created_at|date:"Y/m/d H:i" }}</small>
              <div>{{ m.content }}</div>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-muted">メッセージはまだありません。</p>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}